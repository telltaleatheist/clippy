<!-- Mobile Menu Button -->
<button
  class="mobile-menu-btn"
  (click)="toggleMobileMenu()"
  [attr.aria-label]="mobileMenuOpen() ? 'Close menu' : 'Open menu'"
  [attr.aria-expanded]="mobileMenuOpen()"
>
  <span class="menu-icon" [class.open]="mobileMenuOpen()">
    <span></span>
    <span></span>
    <span></span>
  </span>
</button>

<!-- Sidebar Navigation -->
<nav class="navbar" [class.mobile-open]="mobileMenuOpen()">
  <div class="navbar-container">
    <!-- Logo -->
    <a routerLink="/" class="logo" (click)="closeMobileMenu()">
      <span class="logo-icon">ğŸ¬</span>
      <span class="logo-text gradient-text">ClipChimp</span>
    </a>

    <!-- Current Library -->
    <button class="library-selector" (click)="openLibraryManager()">
      <span class="library-icon">ğŸ“</span>
      <div class="library-info">
        <span class="library-label">Library</span>
        <span class="library-name">
          {{ libraryService.currentLibrary()?.name || 'No Library' }}
        </span>
      </div>
      <span class="library-chevron">â–¼</span>
    </button>

    <!-- Navigation Links -->
    <div class="nav-links">
      @for (link of navLinks; track link.path) {
        <a
          [routerLink]="link.path"
          routerLinkActive="active"
          [routerLinkActiveOptions]="{exact: link.path === '/'}"
          class="nav-link"
          (click)="closeMobileMenu()"
        >
          <span class="nav-icon">{{ link.icon }}</span>
          <span class="nav-label">{{ link.label }}</span>
        </a>
      }
    </div>

    <!-- Controls -->
    <div class="nav-controls">
      <!-- Download Logs -->
      <button
        class="theme-toggle"
        (click)="downloadLogs()"
        aria-label="Download logs"
        title="Download console logs"
      >
        <span class="theme-icon">ğŸ“‹</span>
      </button>

      <!-- Theme Toggle -->
      <button
        class="theme-toggle"
        (click)="toggleTheme()"
        [attr.aria-label]="'Switch to ' + (themeService.isDarkMode() ? 'light' : 'dark') + ' mode'"
      >
        <span class="theme-icon">
          {{ themeService.isDarkMode() ? 'â˜€ï¸' : 'ğŸŒ™' }}
        </span>
      </button>
    </div>
  </div>
</nav>

<!-- Mobile Backdrop -->
@if (mobileMenuOpen()) {
  <div
    class="mobile-backdrop"
    (click)="closeMobileMenu()"
  ></div>
}

<!-- Library Manager Modal -->
<app-library-manager-modal
  [show]="libraryManagerOpen()"
  [existingLibraries]="libraryService.libraries()"
  (closed)="libraryManagerOpen.set(false)"
  (librarySelected)="onLibrarySelected($event)"
  (libraryCreated)="onLibraryCreated($event)"
  (libraryRelinked)="onLibraryRelinked($event)"
/>
