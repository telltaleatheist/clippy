<div class="settings-container">
  <mat-card class="settings-card">
    <mat-card-header>
      <button mat-icon-button (click)="goBack()" aria-label="Back">
        <mat-icon>arrow_back</mat-icon>
      </button>
      <mat-card-title>Settings</mat-card-title>
    </mat-card-header>
    
    <mat-card-content>
      <form [formGroup]="settingsForm" (ngSubmit)="onSubmit()">
        <!-- Download Settings -->
        <h3 class="settings-section-title">Download Settings</h3>
        
        <div class="settings-section">
          <mat-form-field appearance="outline">
            <mat-label>Default Quality</mat-label>
            <mat-select formControlName="quality">
              <mat-option *ngFor="let option of qualityOptions" [value]="option.value">
                {{ option.label }}
              </mat-option>
            </mat-select>
          </mat-form-field>
          
          <div class="checkbox-setting">
            <mat-checkbox formControlName="convertToMp4">Convert to MP4</mat-checkbox>
          </div>
          
          <div class="checkbox-setting">
            <mat-checkbox formControlName="fixAspectRatio">Fix aspect ratio with blurred background</mat-checkbox>
          </div>
          
          <div class="checkbox-setting">
            <mat-checkbox formControlName="useCookies">Use browser cookies</mat-checkbox>
          </div>
          
          <div *ngIf="settingsForm.get('useCookies')?.value">
            <mat-form-field appearance="outline">
              <mat-label>Browser</mat-label>
              <mat-select formControlName="browser">
                <mat-option *ngFor="let option of browserOptions" [value]="option.value">
                  {{ option.label }}
                </mat-option>
              </mat-select>
            </mat-form-field>
          </div>
          
          <mat-form-field appearance="outline">
            <mat-label>Default Output Directory</mat-label>
            <input matInput formControlName="outputDir" readonly>
            <button 
              type="button" 
              mat-icon-button 
              matSuffix 
              (click)="browseOutputDir()" 
              matTooltip="Browse for folder"
            >
              <mat-icon>folder</mat-icon>
            </button>
          </mat-form-field>
        </div>
        <h3 class="settings-section-title">Batch Processing</h3>

        <div class="settings-section">
          <div class="checkbox-setting">
            <mat-checkbox formControlName="batchProcessingEnabled">Enable batch processing</mat-checkbox>
          </div>
          
          <mat-form-field appearance="outline">
            <mat-label>Max Concurrent Downloads</mat-label>
            <input matInput type="number" formControlName="maxConcurrentDownloads" min="1" max="10">
            <mat-hint>Set between 1-10 downloads</mat-hint>
            <mat-error *ngIf="settingsForm.get('maxConcurrentDownloads')?.hasError('required')">
              This field is required
            </mat-error>
            <mat-error *ngIf="settingsForm.get('maxConcurrentDownloads')?.hasError('min')">
              Minimum value is 1
            </mat-error>
            <mat-error *ngIf="settingsForm.get('maxConcurrentDownloads')?.hasError('max')">
              Maximum value is 10
            </mat-error>
          </mat-form-field>
        </div>
        
        <!-- Appearance Settings -->
        <h3 class="settings-section-title">Appearance</h3>
        
        <div class="settings-section">
          <mat-form-field appearance="outline">
            <mat-label>Theme</mat-label>
            <mat-select formControlName="theme">
              <mat-option *ngFor="let option of themeOptions" [value]="option.value">
                {{ option.label }}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </div>
        
        <!-- Action Buttons -->
        <div class="settings-actions">
          <button 
            type="button" 
            mat-stroked-button 
            color="warn" 
            (click)="resetToDefaults()"
          >
            Reset to Defaults
          </button>
          
          <button 
            type="submit" 
            mat-raised-button 
            color="primary"
          >
            Save Settings
          </button>
        </div>
      </form>
    </mat-card-content>
  </mat-card>
</div>