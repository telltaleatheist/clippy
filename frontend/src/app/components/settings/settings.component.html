<div class="settings-container">
  <div class="page-content">
    <div class="panel full-height-panel">
      <div class="panel-header">
        <h2 class="panel-title">
          <mat-icon>settings</mat-icon>
          Settings
        </h2>
      </div>

      <div class="panel-content">
        <form [formGroup]="settingsForm" (ngSubmit)="onSubmit()" class="settings-form">
          <!-- Output Directory -->
          <div class="settings-section">
            <label class="section-label">Output Directory</label>
            <div class="directory-picker">
              <mat-form-field appearance="outline" class="dir-input">
                <input matInput formControlName="outputDir" placeholder="/path/to/folder">
              </mat-form-field>
              <button mat-raised-button color="primary" type="button" (click)="browseOutputDir()" *ngIf="isElectron">
                <mat-icon>folder_open</mat-icon>
                Browse
              </button>
            </div>
            <p class="field-hint">Files will be organized in: <code>videos/</code>, <code>analysis/transcripts/</code>, <code>analysis/reports/</code></p>
          </div>

          <!-- Download Settings -->
          <div class="settings-section">
            <label class="section-label">Download Settings</label>
            <div class="settings-row">
              <mat-form-field appearance="outline">
                <mat-label>Video Quality</mat-label>
                <mat-select formControlName="quality">
                  <mat-option *ngFor="let option of qualityOptions" [value]="option.value">
                    {{option.label}}
                  </mat-option>
                </mat-select>
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Browser</mat-label>
                <mat-select formControlName="browser">
                  <mat-option *ngFor="let browser of browserOptions" [value]="browser.value">
                    {{browser.label}}
                  </mat-option>
                </mat-select>
              </mat-form-field>
            </div>

            <div class="checkbox-row">
              <mat-checkbox formControlName="convertToMp4">Convert to MP4</mat-checkbox>
              <mat-checkbox formControlName="fixAspectRatio">Fix Aspect Ratio</mat-checkbox>
              <mat-checkbox formControlName="useCookies">Use Cookies</mat-checkbox>
            </div>
          </div>

          <!-- Batch Processing -->
          <div class="settings-section">
            <label class="section-label">Batch Processing</label>
            <div class="batch-controls">
              <mat-checkbox formControlName="batchProcessingEnabled">
                Enable Batch Downloads
              </mat-checkbox>
              <mat-form-field appearance="outline" class="concurrent-field">
                <mat-label>Max Concurrent</mat-label>
                <input matInput type="number" formControlName="maxConcurrentDownloads" min="1" max="10">
              </mat-form-field>
            </div>
          </div>

          <!-- Theme -->
          <div class="settings-section">
            <label class="section-label">Appearance</label>
            <div class="theme-row">
              <span>Dark Mode</span>
              <mat-slide-toggle
                [checked]="isDarkTheme$ | async"
                (change)="toggleTheme()">
              </mat-slide-toggle>
            </div>
          </div>
        </form>
      </div>

      <div class="action-buttons">
        <button mat-raised-button type="button" (click)="goBack()">
          <mat-icon>cancel</mat-icon>
          Cancel
        </button>
        <button mat-raised-button color="warn" type="button" (click)="resetToDefaults()">
          <mat-icon>refresh</mat-icon>
          Reset
        </button>
        <button mat-raised-button color="primary" type="submit"
                [disabled]="settingsForm.invalid" (click)="onSubmit()">
          <mat-icon>save</mat-icon>
          Save
        </button>
      </div>
    </div>
  </div>
</div>
