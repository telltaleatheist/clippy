<div class="settings-container">
  <!-- Header -->
  <div class="page-header">
    <h1>
      <mat-icon>settings</mat-icon>
      Settings
    </h1>
    <p class="header-subtitle">Configure your application preferences and download options</p>
  </div>

  <!-- Main Layout -->
  <div class="main-layout">
    <div class="settings-content">
      <form [formGroup]="settingsForm" (ngSubmit)="onSubmit()" class="settings-form">
          <!-- Library Management Info -->
          <div class="form-step info-section">
            <div class="step-content">
              <div class="info-card">
                <mat-icon class="info-icon">info</mat-icon>
                <div class="info-text">
                  <h3>Library-Based Storage</h3>
                  <p>All videos and clips are now managed through libraries. Create and manage libraries from the <strong>Video Library</strong> page to organize your content.</p>
                </div>
              </div>
            </div>
          </div>

          <!-- AI Features Setup -->
          <div class="form-step">
            <div class="step-content">
              <h3 class="step-title">
                <mat-icon>smart_toy</mat-icon>
                AI Features
              </h3>

              <div class="ai-setup-card">
                <div class="ai-status">
                  <div class="status-info">
                    <span class="status-label">Status:</span>
                    <span class="status-value" [class.configured]="hasAnyAIProvider()" [class.not-configured]="!hasAnyAIProvider()">
                      {{ getAIStatusSummary() }}
                    </span>
                  </div>
                  <p class="ai-description">
                    Configure AI providers for video transcription and analysis. <strong>AI features are completely optional</strong> - you can use all core features without AI setup.
                  </p>
                </div>

                <button type="button" mat-raised-button color="primary" (click)="openAISetup()" class="setup-button">
                  <mat-icon>{{ hasAnyAIProvider() ? 'edit' : 'add' }}</mat-icon>
                  {{ hasAnyAIProvider() ? 'Manage AI Setup' : 'Set Up AI Features' }}
                </button>
              </div>
            </div>
          </div>

          <!-- Advanced Tools -->
          <div class="form-step">
            <div class="step-content">
              <h3 class="step-title">
                <mat-icon>build</mat-icon>
                Advanced Tools
              </h3>

              <div class="tools-grid">
                <button type="button" mat-raised-button class="tool-button" (click)="openRelinkFiles()">
                  <mat-icon>link</mat-icon>
                  <div class="tool-info">
                    <span class="tool-title">Relink Files</span>
                    <span class="tool-description">Fix broken file paths and reconnect videos to the library</span>
                  </div>
                </button>

                <button type="button" mat-raised-button class="tool-button" (click)="openAnalysisParameters()">
                  <mat-icon>tune</mat-icon>
                  <div class="tool-info">
                    <span class="tool-title">Analysis Parameters</span>
                    <span class="tool-description">Configure AI analysis prompts and settings</span>
                  </div>
                </button>
              </div>
            </div>
          </div>

          <!-- Download Settings -->
          <div class="form-step">
            <div class="step-content">
              <h3 class="step-title">Download Settings</h3>

              <div class="settings-row">
                <div class="setting-group">
                  <label class="setting-label">
                    <mat-icon>high_quality</mat-icon>
                    Video Quality
                  </label>
                  <select class="modern-select" formControlName="quality">
                    <option *ngFor="let option of qualityOptions" [value]="option.value">
                      {{option.label}}
                    </option>
                  </select>
                </div>

                <div class="setting-group">
                  <label class="setting-label">
                    <mat-icon>web</mat-icon>
                    Browser
                  </label>
                  <select class="modern-select" formControlName="browser">
                    <option *ngFor="let browser of browserOptions" [value]="browser.value">
                      {{browser.label}}
                    </option>
                  </select>
                </div>
              </div>

              <div class="checkbox-group">
                <label class="checkbox-item">
                  <mat-checkbox formControlName="convertToMp4"></mat-checkbox>
                  <span>Convert to MP4</span>
                </label>
                <label class="checkbox-item">
                  <mat-checkbox formControlName="fixAspectRatio"></mat-checkbox>
                  <span>Fix Aspect Ratio</span>
                </label>
                <label class="checkbox-item">
                  <mat-checkbox formControlName="useCookies"></mat-checkbox>
                  <span>Use Cookies</span>
                </label>
              </div>
            </div>
          </div>

          <!-- Batch Processing -->
          <div class="form-step">
            <div class="step-content">
              <h3 class="step-title">Batch Processing</h3>

              <div class="setting-group">
                <label class="setting-label">
                  <mat-icon>list</mat-icon>
                  Max Concurrent Downloads
                </label>
                <input type="number"
                       class="modern-input"
                       formControlName="maxConcurrentDownloads"
                       min="1"
                       max="10"
                       placeholder="3">
              </div>
            </div>
          </div>

          <!-- Theme -->
          <div class="form-step">
            <div class="step-content">
              <h3 class="step-title">Appearance</h3>

              <div class="setting-group">
                <div class="theme-toggle">
                  <div class="theme-label">
                    <mat-icon>dark_mode</mat-icon>
                    <span>Dark Mode</span>
                  </div>
                  <mat-slide-toggle
                    [checked]="isDarkTheme$ | async"
                    (change)="toggleTheme()">
                  </mat-slide-toggle>
                </div>
              </div>
            </div>
          </div>

          <!-- Action Buttons -->
          <div class="action-buttons">
            <button type="button"
                    mat-stroked-button
                    class="secondary-btn"
                    (click)="goBack()">
              <mat-icon>arrow_back</mat-icon>
              Cancel
            </button>
            <button type="submit"
                    mat-raised-button
                    class="primary-btn"
                    [disabled]="settingsForm.invalid"
                    (click)="onSubmit()">
              <mat-icon>save</mat-icon>
              <span>Save Settings</span>
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
