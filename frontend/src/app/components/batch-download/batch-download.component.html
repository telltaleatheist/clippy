<!-- Batch Download - Creamsicle Theme -->
<div class="batch-container">
  <div class="page-content">
    <!-- Job Queue -->
    <div class="panel full-height-panel">
      <div class="panel-header">
        <h4 class="panel-title">ðŸ“Š Job Queue</h4>
        <div class="panel-header-actions">
          <button mat-raised-button (click)="openDownloadOptionsDialog()">
            <mat-icon>settings</mat-icon> Download Options
          </button>
          <button mat-raised-button color="primary" (click)="openPasteUrlsDialog()">
            <mat-icon>add</mat-icon> Paste URLs
          </button>
        </div>
      </div>

      <div class="panel-content">
        <div class="jobs-list">
            <div *ngFor="let job of getAllJobsForDisplay()"
                 class="job-card"
                 [ngClass]="'job-' + (job.status || 'unknown')">
              <div class="job-header">
                <div class="job-title-container">
                  <span class="job-title">{{ getDisplayName(job) }}</span>
                  <span class="job-date" *ngIf="job.uploadDate">{{ job.uploadDate }}</span>
                </div>
                <span class="badge" [ngClass]="'badge-' + getStatusBadgeType(job.status || '')">
                  {{ isProcessingJob(job) ? 'Processing' : job.status }}
                </span>
              </div>

              <div class="job-progress-row">
                <div class="job-progress">
                  <div class="progress-label">
                    {{ job.currentTask || getDefaultTaskForStatus(job.status) }}
                  </div>
                  <div class="progress-bar-container">
                    <div class="progress-bar" [style.width.%]="job.progress || 0"></div>
                  </div>
                  <div class="progress-value">{{ job.progress || 0 }}%</div>
                </div>

                <div class="job-actions">
                  <!-- Pending jobs: show remove button -->
                  <button *ngIf="job.status === 'pending'"
                          mat-icon-button
                          (click)="removePendingJob(job.id)"
                          matTooltip="Remove">
                    <mat-icon>close</mat-icon>
                  </button>

                  <!-- Active/failed jobs: show error/cancel/retry buttons -->
                  <button *ngIf="job.status === 'failed'"
                          mat-icon-button
                          (click)="showJobError(job)"
                          matTooltip="View Error">
                    <mat-icon>error_outline</mat-icon>
                  </button>
                  <button *ngIf="job.status !== 'completed' && job.status !== 'pending'"
                          mat-icon-button
                          (click)="cancelJob(job.id)"
                          matTooltip="Cancel">
                    <mat-icon>close</mat-icon>
                  </button>
                  <button *ngIf="job.status === 'failed'"
                          mat-icon-button
                          (click)="retryJob(job.id)"
                          matTooltip="Retry">
                    <mat-icon>refresh</mat-icon>
                  </button>
                </div>
              </div>
            </div>

          <div class="empty-state" *ngIf="getAllJobsForDisplay().length === 0">
            <mat-icon class="empty-icon">inbox</mat-icon>
            <p>No active jobs</p>
            <p class="empty-hint">Click "Paste URLs" to add videos to the queue</p>
          </div>
        </div>

        <div class="panel-actions">
          <button mat-raised-button color="primary" (click)="startQueue()" [disabled]="!hasPendingJobs()">
            <mat-icon>play_arrow</mat-icon> Start Queue
          </button>

          <button mat-stroked-button color="warn" (click)="clearQueue()"
                [disabled]="!hasActiveJobs()">
            <mat-icon>clear_all</mat-icon> Clear Queue
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
